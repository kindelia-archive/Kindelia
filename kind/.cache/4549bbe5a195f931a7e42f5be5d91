#context #world #term #type (((context #context Bool) ((((((((((term #term Bool) #term.name ((((((Map.get Kindelia.Type) term.name) context) #got Bool) Bool.false) #got.value ((Kindelia.equal got.value) type))) #term.name #term.type #term.expr #term.body !expr = ((((Kindelia.check context) world) term.expr) term.type); !body = ((((Kindelia.check ((((Map.set Kindelia.Type) term.name) term.type) context)) world) term.body) type); ((Bool.and expr) body)) #term.bond #term.args (((((Kindelia.get_bond world) term.bond) # Bool) Bool.false) #bond !bond = bond; ((bond #bond Bool) #bond.name #bond.ownr #bond.args #bond.otyp #bond.main !size = ((Nat.eql ((List.length Kindelia.Term) term.args)) ((List.length ((Pair String) Kindelia.Type)) bond.args)); !otyp = ((Kindelia.equal bond.otyp) type); !args = Bool.true; !args = (((((List.for ((Pair Kindelia.Term) Kindelia.Type)) ((Kindelia.call_list term.args) bond.args)) Bool) args) #arg #args ((Bool.and args) ((((Kindelia.check context) world) ((arg # Kindelia.Term) #fst #snd fst)) ((arg # Kindelia.Type) #fst #snd snd)))); ((Bool.and size) ((Bool.and otyp) args))))) #term.ctor #term.vals (((type #type Bool) Bool.false) #type.name (((((Kindelia.get_data world) type.name) # Bool) Bool.false) #data !data = data; ((data #data Bool) #data.name #data.ctrs ((((((List.get Kindelia.Constructor) term.ctor) data.ctrs) # Bool) Bool.false) #ctor !ctor = ctor; ((ctor #ctor Bool) #ctor.name #ctor.args !size = ((Nat.eql ((List.length Kindelia.Term) term.vals)) ((List.length ((Pair String) Kindelia.Type)) ctor.args)); !vals = Bool.true; !vals = (((((List.for ((Pair Kindelia.Term) Kindelia.Type)) ((Kindelia.call_list term.vals) ctor.args)) Bool) vals) #arg #vals ((Bool.and vals) ((((Kindelia.check context) world) ((arg # Kindelia.Term) #fst #snd fst)) ((arg # Kindelia.Type) #fst #snd snd)))); ((Bool.and size) vals))))))) #term.name #term.data #term.cses (((((Kindelia.get_data world) term.data) # Bool) Bool.false) #data !data = data; ((data #data Bool) #data.name #data.ctrs !size = ((Nat.eql ((List.length Kindelia.Term) term.cses)) ((List.length Kindelia.Constructor) data.ctrs)); !expr = ((((Kindelia.check context) world) (Kindelia.Term.var term.name)) (Kindelia.Type.data term.data)); !cses = Bool.true; !cses = (((((List.for ((Pair Kindelia.Args) Kindelia.Term)) (((Kindelia.case_list term.name) data.ctrs) term.cses)) Bool) cses) #cse #cses ((Bool.and cses) ((((Kindelia.check (((Kindelia.extend Kindelia.Type) context) ((cse # (List ((Pair String) Kindelia.Type))) #fst #snd fst))) world) ((cse # Kindelia.Term) #fst #snd snd)) type))); ((Bool.and size) cses)))) #term.numb (((type #type Bool) Bool.true) #type.name Bool.false)) #term.val0 #term.val1 #term.iflt #term.ifeq #term.ifgt !val0 = ((((Kindelia.check context) world) term.val0) Kindelia.Type.word); !val1 = ((((Kindelia.check context) world) term.val1) Kindelia.Type.word); !iflt = ((((Kindelia.check context) world) term.iflt) type); !ifeq = ((((Kindelia.check context) world) term.ifeq) type); !ifgt = ((((Kindelia.check context) world) term.ifgt) type); ((Bool.and val0) ((Bool.and val1) ((Bool.and iflt) ((Bool.and ifeq) ifgt))))) #term.oper #term.val0 #term.val1 !val0 = ((((Kindelia.check context) world) term.val0) Kindelia.Type.word); !val1 = ((((Kindelia.check context) world) term.val1) Kindelia.Type.word); ((Bool.and val0) val1)) #term.bond #term.expr #term.cont (((((Kindelia.get_bond world) term.bond) # Bool) Bool.false) #bond !bond = bond; ((bond #bond Bool) #bond.name #bond.ownr #bond.args #bond.otyp #bond.main !notf = ((List.is_empty ((Pair String) Kindelia.Type)) bond.args); !expr = ((((Kindelia.check context) world) term.expr) bond.otyp); !cont = ((((Kindelia.check context) world) term.cont) type); ((Bool.and notf) ((Bool.and expr) cont)))))) #context.size #context.key #context.val #context.left #context.right ((((((((((term #term Bool) #term.name ((((((Map.get Kindelia.Type) term.name) context) #got Bool) Bool.false) #got.value ((Kindelia.equal got.value) type))) #term.name #term.type #term.expr #term.body !expr = ((((Kindelia.check context) world) term.expr) term.type); !body = ((((Kindelia.check ((((Map.set Kindelia.Type) term.name) term.type) context)) world) term.body) type); ((Bool.and expr) body)) #term.bond #term.args (((((Kindelia.get_bond world) term.bond) # Bool) Bool.false) #bond !bond = bond; ((bond #bond Bool) #bond.name #bond.ownr #bond.args #bond.otyp #bond.main !size = ((Nat.eql ((List.length Kindelia.Term) term.args)) ((List.length ((Pair String) Kindelia.Type)) bond.args)); !otyp = ((Kindelia.equal bond.otyp) type); !args = Bool.true; !args = (((((List.for ((Pair Kindelia.Term) Kindelia.Type)) ((Kindelia.call_list term.args) bond.args)) Bool) args) #arg #args ((Bool.and args) ((((Kindelia.check context) world) ((arg # Kindelia.Term) #fst #snd fst)) ((arg # Kindelia.Type) #fst #snd snd)))); ((Bool.and size) ((Bool.and otyp) args))))) #term.ctor #term.vals (((type #type Bool) Bool.false) #type.name (((((Kindelia.get_data world) type.name) # Bool) Bool.false) #data !data = data; ((data #data Bool) #data.name #data.ctrs ((((((List.get Kindelia.Constructor) term.ctor) data.ctrs) # Bool) Bool.false) #ctor !ctor = ctor; ((ctor #ctor Bool) #ctor.name #ctor.args !size = ((Nat.eql ((List.length Kindelia.Term) term.vals)) ((List.length ((Pair String) Kindelia.Type)) ctor.args)); !vals = Bool.true; !vals = (((((List.for ((Pair Kindelia.Term) Kindelia.Type)) ((Kindelia.call_list term.vals) ctor.args)) Bool) vals) #arg #vals ((Bool.and vals) ((((Kindelia.check context) world) ((arg # Kindelia.Term) #fst #snd fst)) ((arg # Kindelia.Type) #fst #snd snd)))); ((Bool.and size) vals))))))) #term.name #term.data #term.cses (((((Kindelia.get_data world) term.data) # Bool) Bool.false) #data !data = data; ((data #data Bool) #data.name #data.ctrs !size = ((Nat.eql ((List.length Kindelia.Term) term.cses)) ((List.length Kindelia.Constructor) data.ctrs)); !expr = ((((Kindelia.check context) world) (Kindelia.Term.var term.name)) (Kindelia.Type.data term.data)); !cses = Bool.true; !cses = (((((List.for ((Pair Kindelia.Args) Kindelia.Term)) (((Kindelia.case_list term.name) data.ctrs) term.cses)) Bool) cses) #cse #cses ((Bool.and cses) ((((Kindelia.check (((Kindelia.extend Kindelia.Type) context) ((cse # (List ((Pair String) Kindelia.Type))) #fst #snd fst))) world) ((cse # Kindelia.Term) #fst #snd snd)) type))); ((Bool.and size) cses)))) #term.numb (((type #type Bool) Bool.true) #type.name Bool.false)) #term.val0 #term.val1 #term.iflt #term.ifeq #term.ifgt !val0 = ((((Kindelia.check context) world) term.val0) Kindelia.Type.word); !val1 = ((((Kindelia.check context) world) term.val1) Kindelia.Type.word); !iflt = ((((Kindelia.check context) world) term.iflt) type); !ifeq = ((((Kindelia.check context) world) term.ifeq) type); !ifgt = ((((Kindelia.check context) world) term.ifgt) type); ((Bool.and val0) ((Bool.and val1) ((Bool.and iflt) ((Bool.and ifeq) ifgt))))) #term.oper #term.val0 #term.val1 !val0 = ((((Kindelia.check context) world) term.val0) Kindelia.Type.word); !val1 = ((((Kindelia.check context) world) term.val1) Kindelia.Type.word); ((Bool.and val0) val1)) #term.bond #term.expr #term.cont (((((Kindelia.get_bond world) term.bond) # Bool) Bool.false) #bond !bond = bond; ((bond #bond Bool) #bond.name #bond.ownr #bond.args #bond.otyp #bond.main !notf = ((List.is_empty ((Pair String) Kindelia.Type)) bond.args); !expr = ((((Kindelia.check context) world) term.expr) bond.otyp); !cont = ((((Kindelia.check context) world) term.cont) type); ((Bool.and notf) ((Bool.and expr) cont))))))