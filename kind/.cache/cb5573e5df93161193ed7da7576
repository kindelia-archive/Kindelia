#A #pars #pst ((pst #pst (Parser.Reply A)) #pst.err #pst.nam #pst.ini #pst.idx #pst.str (((pars #pars (Parser.Reply A)) (((pst.err #pst.err (Parser.Reply A)) (((((Parser.Reply.fail A) pst.nam) pst.ini) pst.idx) "No parse.")) #pst.err.value ((Parser.Reply.error A) pst.err.value))) #pars.head #pars.tail !parsed = (pars.head pst); (((parsed #parsed (Parser.Reply A)) #parsed.err !cur_err = ((Maybe.some Parser.Error) parsed.err); !far_err = ((Parser.Error.maybe_combine pst.err) cur_err); !new_pst = (((((Parser.State.new far_err) pst.nam) pst.ini) pst.idx) pst.str); (((Parser.choice A) pars.tail) new_pst)) #parsed.pst #parsed.val (((Parser.Reply.value A) parsed.pst) parsed.val))))